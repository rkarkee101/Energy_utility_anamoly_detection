# Energy_utility_anamoly_detection

Monitoring school energy usage is crucial for identifying inefficiencies, equipment malfunctions, or underperforming retrofits. Anomalies in energy data can appear as single outlier points (e.g. a sudden spike in usage) or as subtle trends over time (e.g. a sustained period of slightly higher consumption). In anomaly detection literature, these are often called point anomalies and collective anomalies respectively. A collective anomaly refers to a set of data points that deviate from expectations only when considered together (even if individual points seem normal).
In the context of school utility bills (monthly energy usage), point anomalies might indicate events like equipment left running, while small trend anomalies could signal one building’s performance gradually worsening. The following sections provide two Python code examples to detect such anomalies using data-driven techniques:
•	Part 1: Detect anomalies (both point outliers and small trend deviations) in a single school’s energy usage time series (general utility bill data).
•	Part 2: Analyze multiple schools’ energy data before and after efficiency retrofits to identify any underperforming buildings (those that did not improve as expected), again capturing both point and trend anomalies in their performance.
Throughout, we normalize energy use by building size (energy per square foot, also known as Energy Use Intensity, EUI) for fair comparisons. We leverage advanced machine learning-based anomaly detection methods (e.g. Isolation Forest, one-class SVM) which have been shown to work well for energy data, and we discuss how to catch subtle collective anomalies (using sequences or trend models).
Part 1: Detecting Anomalies in a Single Building’s Utility Time Series
For a single school’s monthly utility data, we want to flag: - Point anomalies: individual months with abnormally high or low usage. - Small trend anomalies (collective anomalies): a group of months showing a slight but sustained deviation (e.g. a 3-month upward trend in energy use that is unusual).
Approach:
1. Load and Prepare Data: Read the CSV file containing monthly utility data (electricity kWh, gas, dates, etc.). If the file contains multiple schools, filter for the specific school of interest. Ensure the data is in chronological order and handle missing values if any. 2. Feature Engineering: For time-series anomaly detection, capturing seasonality is important. You may create features like month-of-year or use year-over-year comparisons. In this example, we’ll focus on electricity usage (kWh) and incorporate the month as a feature for seasonal context. 3. Apply Anomaly Detection Model: Use an unsupervised ML model to detect outliers. We choose Isolation Forest (an ensemble method that isolates anomalies in the data) to detect point anomalies. Isolation Forest is effective for detecting outliers in energy consumption data. We set a contamination rate (expected proportion of anomalies) to guide the model. 4. Identify Anomalies: The model will assign an anomaly score to each point. We flag points with the lowest scores (predicted as outliers) as point anomalies. 5. Detect Collective Anomalies: To catch subtle trends, we examine if anomalies or high anomaly-scores occur in consecutive periods. A simple heuristic: if three or more months in a row show moderately high usage (even if each month alone is not extreme), we flag that sequence as a collective anomaly. More sophisticated approaches for collective anomalies include using time-series forecasting models (like Prophet or LSTM) to detect sustained deviations, but we will illustrate a simple method for clarity. 6. Output Results: The code will output the identified anomaly points (with timestamps) and any detected anomaly trends.
Example Illustration: Below is a synthetic example of a school’s energy usage over time, with a single-month spike (point anomaly) and a 3-month sustained higher usage (collective anomaly). The anomalies are marked in red for visualization:
Example energy usage time series for a school, with a point anomaly (single spike) and a collective anomaly (3-month upward trend) highlighted in red.
